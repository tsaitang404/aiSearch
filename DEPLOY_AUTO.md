# è‡ªåŠ¨éƒ¨ç½²é…ç½®æŒ‡å—

## æ¦‚è¿°

æœ¬é¡¹ç›®å·²é…ç½®GitHub Actionsè‡ªåŠ¨éƒ¨ç½²åŠŸèƒ½ï¼Œå½“æ¨é€ä»»ä½•`v*`ç‰ˆæœ¬æ ‡ç­¾æ—¶ï¼Œä¼šè‡ªåŠ¨éƒ¨ç½²åˆ°Cloudflare Workerã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. é…ç½®GitHub Secrets

åœ¨GitHubä»“åº“è®¾ç½®ä¸­æ·»åŠ ä»¥ä¸‹Secretsï¼š

- `CLOUDFLARE_API_TOKEN`: Cloudflare API Token
- `CLOUDFLARE_ACCOUNT_ID`: Cloudflare Account ID

è¯¦ç»†è·å–æ–¹å¼è¯·å‚è€ƒï¼š
- [é…ç½®æ–‡æ¡£](.github/README.md) - åŸºç¡€é…ç½®
- [APIæƒé™è¯¦ç»†æŒ‡å—](docs/CF_API_PERMISSIONS.md) - å®Œæ•´æƒé™é…ç½®è¯´æ˜

### 2. å‘å¸ƒæ–°ç‰ˆæœ¬

ä½¿ç”¨å†…ç½®çš„å‘å¸ƒè„šæœ¬ï¼š

```bash
# äº¤äº’å¼å‘å¸ƒ
npm run release

# æˆ–è€…æ‰‹åŠ¨åˆ›å»ºæ ‡ç­¾ï¼ˆæ”¯æŒä»»ä½•vå¼€å¤´çš„ç‰ˆæœ¬ï¼‰
git tag v1.0.0
git push origin v1.0.0

# å…¶ä»–ç¤ºä¾‹
git tag v2.1.3
git push origin v2.1.3
```

### 3. ç›‘æ§éƒ¨ç½²

- æŸ¥çœ‹GitHub Actions: [Actionsé¡µé¢](../../actions)
- éƒ¨ç½²å®Œæˆåè®¿é—®: https://neoai.tsaitang.workers.dev

## ğŸ“‹ éƒ¨ç½²æµç¨‹

å½“ä½ æ¨é€ä»»ä½•`v*`æ ‡ç­¾åï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œï¼š

1. âœ… **ä»£ç æ£€å‡º** - è·å–æ ‡ç­¾å¯¹åº”çš„ä»£ç 
2. âœ… **ç¯å¢ƒè®¾ç½®** - å®‰è£…Node.js 18å’Œä¾èµ–
3. âœ… **é…ç½®éªŒè¯** - æ£€æŸ¥wrangleré…ç½®
4. âœ… **ä»£ç æ£€æŸ¥** - è¿è¡ŒåŸºç¡€éªŒè¯
5. âœ… **è‡ªåŠ¨éƒ¨ç½²** - éƒ¨ç½²åˆ°Cloudflare Worker
6. âœ… **çŠ¶æ€æ£€æŸ¥** - éªŒè¯éƒ¨ç½²æ˜¯å¦æˆåŠŸ

## ğŸ› ï¸ æœ¬åœ°å¼€å‘

```bash
# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev

# éªŒè¯é…ç½®
npm run validate

# æ‰‹åŠ¨éƒ¨ç½²ï¼ˆå¯é€‰ï¼‰
npm run deploy
```

## ğŸ“Š ç‰ˆæœ¬ç®¡ç†

### ç‰ˆæœ¬æ ¼å¼
- æ ¼å¼: `v*` (ä»»ä½•ä»¥vå¼€å¤´çš„æ ‡ç­¾)
- ç¤ºä¾‹: `v1.0.0`, `v2.1.3`, `v0.1.0`, `v1.2.0-beta.1`

### å‘å¸ƒæµç¨‹
1. å®Œæˆä»£ç å¼€å‘å’Œæµ‹è¯•
2. æäº¤å¹¶æ¨é€åˆ°ä¸»åˆ†æ”¯
3. è¿è¡Œ `npm run release` åˆ›å»ºç‰ˆæœ¬æ ‡ç­¾
4. GitHub Actionsè‡ªåŠ¨éƒ¨ç½²åˆ°Cloudflare Worker

### ç‰ˆæœ¬å†å²
```bash
# æŸ¥çœ‹å·²å‘å¸ƒçš„ç‰ˆæœ¬ï¼ˆä»»ä½•vå¼€å¤´çš„æ ‡ç­¾ï¼‰
git tag -l "v*" | sort -V

# æŸ¥çœ‹æœ€æ–°ç‰ˆæœ¬
git describe --tags --abbrev=0
```

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **éƒ¨ç½²å¤±è´¥**
   - æ£€æŸ¥Secretsæ˜¯å¦æ­£ç¡®é…ç½®
   - æŸ¥çœ‹Actionsæ—¥å¿—è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯
   - ç¡®ä¿wrangleré…ç½®æ­£ç¡®

2. **Workeræ— æ³•è®¿é—®**
   - éƒ¨ç½²åç­‰å¾…1-2åˆ†é’Ÿè®©å˜æ›´ç”Ÿæ•ˆ
   - æ£€æŸ¥Cloudflare Dashboardä¸­WorkerçŠ¶æ€
   - ç¡®è®¤åŸŸåé…ç½®æ­£ç¡®

3. **æƒé™é—®é¢˜**
   - ç¡®ä¿API Tokenæœ‰è¶³å¤Ÿæƒé™
   - æ£€æŸ¥Account IDæ˜¯å¦æ­£ç¡®

### è°ƒè¯•å‘½ä»¤

```bash
# æ£€æŸ¥WorkerçŠ¶æ€
npm run status

# æŸ¥çœ‹å®æ—¶æ—¥å¿—
npm run logs

# è·å–Worker URL
npm run get-worker-url

# éªŒè¯é…ç½®æ–‡ä»¶
npm run validate

# æ£€æŸ¥GitHub Secretsé…ç½®
npm run check-secrets

# éªŒè¯Cloudflare APIæƒé™ï¼ˆéœ€è¦è®¾ç½®ç¯å¢ƒå˜é‡ï¼‰
npm run check-cf-permissions
```

## ğŸ“ é…ç½®æ–‡ä»¶è¯´æ˜

- `.github/workflows/deploy.yml` - GitHub Actionså·¥ä½œæµ
- `.github/scripts/get-worker-url-ci.sh` - CIä¸“ç”¨URLè·å–è„šæœ¬
- `scripts/release.sh` - ç‰ˆæœ¬å‘å¸ƒè„šæœ¬
- `config/wrangler.toml` - Cloudflare Workeré…ç½®

## ğŸ” å®‰å…¨æ³¨æ„äº‹é¡¹

### GitHub Secrets å®‰å…¨æ€§ä¿éšœ

âœ… **åŠ å¯†å­˜å‚¨**: Secretsåœ¨GitHubæœåŠ¡å™¨ä¸Šä½¿ç”¨å·¥ä¸šçº§æ ‡å‡†åŠ å¯†ç®—æ³•å­˜å‚¨  
âœ… **è®¿é—®æ§åˆ¶**: åªæœ‰ä»“åº“ç®¡ç†å‘˜å’Œå…·æœ‰å†™æƒé™çš„ç”¨æˆ·æ‰èƒ½æŸ¥çœ‹/ä¿®æ”¹  
âœ… **è‡ªåŠ¨è„±æ•**: åœ¨æ‰€æœ‰æ—¥å¿—å’Œè¾“å‡ºä¸­ï¼ŒSecretså€¼ä¼šè‡ªåŠ¨æ˜¾ç¤ºä¸º`***`  
âœ… **éš”ç¦»è¿è¡Œ**: åªåœ¨Actionså®‰å…¨ç¯å¢ƒä¸­å¯ç”¨ï¼Œä¸ä¼šæ³„æ¼åˆ°PRæˆ–fork  
âœ… **ä¸å¯å¯¼å‡º**: æ— æ³•é€šè¿‡ä»»ä½•æ–¹å¼åœ¨Actionsä¸­æ‰“å°æˆ–å¯¼å‡ºSecretså€¼  

### æœ€ä½³å®è·µ

- API Tokenåªæˆäºˆå¿…è¦çš„æœ€å°æƒé™
- ä¸è¦åœ¨ä»£ç ä¸­ç¡¬ç¼–ç ä»»ä½•æ•æ„Ÿä¿¡æ¯
- å®šæœŸè½®æ¢API Tokenï¼ˆå»ºè®®æ¯6ä¸ªæœˆï¼‰
- ç›‘æ§Workerçš„ä½¿ç”¨æƒ…å†µå’Œæ—¥å¿—
- å®šæœŸæ£€æŸ¥GitHubä»“åº“çš„è®¿é—®æƒé™

### Secretsé…ç½®éªŒè¯

é…ç½®å®Œæˆåï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼éªŒè¯ï¼š

```bash
# åˆ›å»ºæµ‹è¯•æ ‡ç­¾è§¦å‘éƒ¨ç½²
git tag v1.0.0-test
git push origin v1.0.0-test

# åœ¨Actionsæ—¥å¿—ä¸­åº”è¯¥çœ‹åˆ°ï¼š
# âœ… Secretsæ­£ç¡®åŠ è½½ï¼ˆä¸ä¼šæ˜¾ç¤ºå®é™…å€¼ï¼‰
# âœ… Wranglerè®¤è¯æˆåŠŸ
# âœ… Workeréƒ¨ç½²æˆåŠŸ
```

## ğŸ“ è·å–å¸®åŠ©

å¦‚æœé‡åˆ°é—®é¢˜ï¼š

1. æŸ¥çœ‹ [GitHub Actionsæ—¥å¿—](../../actions)
2. æ£€æŸ¥ [Cloudflare Dashboard](https://dash.cloudflare.com)
3. å‚è€ƒ [Wrangleræ–‡æ¡£](https://developers.cloudflare.com/workers/wrangler/)
4. æŸ¥çœ‹é¡¹ç›®Issues
